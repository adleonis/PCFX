{
  "$id": "https://pcfx.org/schemas/exposure_event-0.1.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "required": ["schema","id","ts","device","adapter_id","capabilities_used","source","content","privacy","signature"],
  "properties": {
    "schema": { "const": "pcfx.exposure_event/0.1" },
    "id": { "type": "string" },
    "ts": { "type": "string", "format": "date-time" },
    "device": { "type": "string" },
    "adapter_id": { "type": "string" },
    "capabilities_used": { "type": "array", "items": { "type": "string" } },
    "source": {
      "type":"object",
      "required":["surface"],
      "properties":{
        "surface":{"type":"string","enum":["app","browser","audio","tv","wearable","system"]},
        "app":{"type":"string"},
        "url":{"type":"string"},
        "frame":{"type":"string"}
      },
      "additionalProperties": false
    },
    "content": {
      "type":"object",
      "required":["kind"],
      "properties":{
        "kind":{"type":"string","enum":["text","audio","image","video","ad","system"]},
        "text":{"type":"string"},
        "lang":{"type":"string"},
        "blob_ref":{"type":"string"}
      },
      "additionalProperties": false
    },
    "privacy": {
      "type":"object",
      "required":["consent_id","retention_days"],
      "properties":{
        "consent_id":{"type":"string"},
        "pii_flags":{"type":"array","items":{"type":"string"}},
        "retention_days":{"type":"integer","minimum":0}
      },
      "additionalProperties": false
    },
    "extensions": { "type": "object" },
    "signature": { "type": "string" }
  },
  "additionalProperties": false
}
